<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ラノベ新刊（テスト）</title>
  <style>
    body { font-family: system-ui, -apple-system, "Hiragino Sans", "Noto Sans JP", sans-serif; margin: 0; background:#fafafa; }
    .wrap { padding: 12px; }
    .topbar { display:flex; gap:10px; align-items: baseline; flex-wrap: wrap; margin-bottom: 10px; }
    .h { font-size: 16px; font-weight: 800; margin: 0; }
    .note { font-size: 12px; opacity: .75; margin: 0; }

    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 12px; }
    .card { border: 1px solid #e2e2e2; border-radius: 12px; overflow: hidden; background: #fff; display: flex; flex-direction: column; }
    .cover { background: #f2f2f2; aspect-ratio: 1 / 1; display: grid; place-items: center; }
    .cover img { width: 100%; height: 100%; object-fit: contain; display: block; }

    .meta { padding: 10px; display: flex; flex-direction: column; gap: 8px; }
    .title { font-size: 14px; line-height: 1.35; margin: 0; font-weight: 800; }
    .sub { font-size: 12px; opacity: .8; display: flex; gap: 6px; flex-wrap: wrap; }
    .sep { opacity: .45; }

    .links { margin-top: 2px; display:flex; gap:10px; flex-wrap: wrap; }
    .btn { display: inline-block; font-size: 12px; text-decoration: none; border: 1px solid #e2e2e2; padding: 7px 10px; border-radius: 10px; }
    .btn:active { transform: translateY(1px); }

    /* iframe内での余白が見えるように */
    .foot { margin-top: 14px; font-size: 12px; opacity:.7; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <h1 class="h">ラノベ新刊一覧（テスト）</h1>
      <p class="note">※ダミーデータ。表示・スクロール確認用。</p>
    </div>

    <div class="grid" id="grid"></div>

    <div class="foot">
      <p>表示が崩れる/スクロールが変などあれば教えて。ここがOKになったら次にopenBD連携へ。</p>
    </div>
  </div>

<script>
  // ★あなたのAmazonアソシエイトタグに置き換え（例: "yourtag-22"）
  const AMAZON_TAG = "mozublo-22";

  function amazonUrlFromIsbn(isbn) {
    const q = encodeURIComponent(isbn);
    return `https://www.amazon.co.jp/s?k=${q}&tag=${encodeURIComponent(AMAZON_TAG)}`;
  }

  // ダミー：書影は見た目確認用（外部URLの画像）
  // 本番では openBDのcover URLに置き換える
  const dummy = [
    { title:"ダミー新刊1：タイトルが長い場合の折り返し確認テスト", author:"著者名A", date:"2026-01-15", publisher:"出版社A", isbn:"9784040000001", cover:"https://placehold.co/600x600?text=Cover+1" },
    { title:"ダミー新刊2", author:"著者名B", date:"2026-01-15", publisher:"出版社B", isbn:"9784040000002", cover:"https://placehold.co/600x600?text=Cover+2" },
    { title:"ダミー新刊3", author:"著者名C", date:"2026-01-16", publisher:"出版社C", isbn:"9784040000003", cover:"https://placehold.co/600x600?text=Cover+3" },
    { title:"ダミー新刊4", author:"著者名D", date:"2026-01-16", publisher:"出版社D", isbn:"9784040000004", cover:"https://placehold.co/600x600?text=Cover+4" },
    { title:"ダミー新刊5", author:"著者名E", date:"2026-01-17", publisher:"出版社E", isbn:"9784040000005", cover:"https://placehold.co/600x600?text=Cover+5" },
    { title:"ダミー新刊6", author:"著者名F", date:"2026-01-17", publisher:"出版社F", isbn:"9784040000006", cover:"https://placehold.co/600x600?text=Cover+6" },
    { title:"ダミー新刊7", author:"著者名G", date:"2026-01-18", publisher:"出版社G", isbn:"9784040000007", cover:"https://placehold.co/600x600?text=Cover+7" },
    { title:"ダミー新刊8", author:"著者名H", date:"2026-01-18", publisher:"出版社H", isbn:"9784040000008", cover:"https://placehold.co/600x600?text=Cover+8" },
    { title:"ダミー新刊9", author:"著者名I", date:"2026-01-19", publisher:"出版社I", isbn:"9784040000009", cover:"https://placehold.co/600x600?text=Cover+9" },
    { title:"ダミー新刊10", author:"著者名J", date:"2026-01-19", publisher:"出版社J", isbn:"9784040000010", cover:"https://placehold.co/600x600?text=Cover+10" },
  ];

  function escapeHtml(str) {
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function makeCard(x) {
    const aUrl = amazonUrlFromIsbn(x.isbn);
    const el = document.createElement("article");
    el.className = "card";
    el.innerHTML = `
      <div class="cover">
        <img src="${escapeHtml(x.cover)}" alt="${escapeHtml(x.title)}">
      </div>
      <div class="meta">
        <h3 class="title">${escapeHtml(x.title)}</h3>
        <div class="sub">
          <span>${escapeHtml(x.author)}</span>
          <span class="sep">/</span>
          <span>${escapeHtml(x.date)}</span>
          <span class="sep">/</span>
          <span>${escapeHtml(x.publisher)}</span>
        </div>
        <div class="links">
          <a class="btn" href="${aUrl}" target="_blank" rel="nofollow noopener">Amazonで見る</a>
        </div>
      </div>
    `;
    return el;
  }

  const grid = document.getElementById("grid");
  dummy.forEach(x => grid.appendChild(makeCard(x)));
</script>
</body>
</html>
